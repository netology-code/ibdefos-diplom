# Итоговая работа «Уязвимости виртуальной среды» по курсу «Безопасность операционных систем. Аttack & Defence»

### Цель проекта

Цель - провести тестирование уязвимостей виртуальной среды.

Вам предстоит:

- удалённо подключиться к уязвимой виртуальной машине по ssh;
- использовать sql-инъекцию в уязвимом сервисе для получения хэша пароля от учётной записи руководителя (boss),
- расшифровать хэш от учётной записи boss;
- удалённо подключиться по ssh с использованием учётной записи boss и просмотреть конфиденцильный файл в его домашнем каталоге;
- расшифровать хэш от учётной записи msfadmin и выступить уже в роли защитника, приняв необходимые меры по защите виртуальной машины.

-----

### Чек-лист готовности к курсовой работе

1. Установлен VirtualBox.
2. Скачана уязвимая виртуальная машина (ссылка размещена к занятию в личном кабинете).
3. Дополнительно развёрнута виртуальная машина Kali Linux.

------

### Инструменты и дополнительные материалы, которые пригодятся для выполнения задания

1. VirtualBox ([ссылка на инструкцию по установке](https://github.com/netology-code/ibnet-homeworks/blob/v2/virtualbox/virtualbox.md)).
2. Kali Linux ([ссылка на инструкцию по установке](https://help.reg.ru/support/vydelennyye-servery-i-dc/vmware-virtualnyy-data-tsentr/sozdaniye-i-nastroyka-virtualnykh-mashin/kak-ustanovit-kali-linux-na-virtualbox)).
3. Hashcat для расшифровки хэшей ([ссылка на инструкцию по установке](https://github.com/netology-code/ibb-homeworks/tree/IBB-33/07_crypto-symmetric)).
4. Nmap для сканирования портов.
5. Материалы занятий «Атаки», «SQL и транзакции» в личном кабинете.

-----

### Инструкция к выполнению курсовой работы

#### Входные данные

Перед вами стоит задача провести тестирование уязвимостей доступа к конфиденциальной информации вашего руководителя. Руководитель хранит документ с ограниченным доступом в своей учётной записи.

Вы будете использовать уязвимости виртуальной машины с целью похищения содержания конфиденциального документа руководителя. Для этого вы внедритесь по сети с использованием удалённого подключения по ssh. После этого вам предстоит выступить в роли специалиста по ИБ и закрыть уязвимости виртуальной машины. В результате работы вы сформируете отчёт, который будет состоять из скриншотов, фиксирующих отдельные шаги выполнения работы.

Вам стало известно, что для тестирования используется стандартная учётная запись «test» с паролем «test».

Имеется сервис для просмотра текущих задач сотрудников (bd/tasks). Для доступа к просмотру задач используется учётная запись «user», пароль - любой.
IP-адрес уязвимой машины - `10.1.1.100`, маска - `255.255.255.0`.

#### Алгоритм задания

1. Импортируйте скачанную уязвимую виртуальную машину.

**Важно!** В строке «Политика MAC-адреса» необходимо выбрать «Включать MAC-адреса для всех сетевых адаптеров», как показано на рисунке:

![Снимок](https://github.com/netology-code/ibdefos-diplom/assets/96241243/3a54fa9f-757f-453d-a529-705a94a9ddf5)


2. С помощью Nmap просканируйте открытые порты уязвимой машины. Вам необходимо убедиться, что порт 22 открыт. На этом порте работает ssh. Сделайте скриншот. Он вам понадобится для отчёта.

3. Подключитесь к уязвимой машине по ssh, используя учётную запись «test». Сделайте скриншот.

<details>
  <summary> Подсказка</summary>

Так как уязвимая машина использует устаревшие версии, применяйте команду с ключом `ssh -oHostKeyAlgorithms=+ssh-dss  test@10.1.1.100`.
  
</details>

4. Перейдите в каталог bd, где располагается сервис tasks. Каталог bd расположен в корневом каталоге с var, tmp и др. Запустите сервис tasks. Введите имя пользователя «user», пароль - любой. Сделайте снимок экрана, чтобы было видно отображение задач.

<details>
  <summary> Подсказка</summary>

Для запуска сервиса выполните команду `./tasks` из каталога bd.
  
</details>

5. Попытайтесь сломать сервис, используя sql-инъекцию или неверные данные ввода. В итоге вы должны увидеть учётные записи с хэшами паролей. Сделайте скриншот.

6. С использованием hashcat расшифруйте пароль для учётной записи «boss» и под ней подключитесь по ssh.

<details>
  <summary> Подсказка</summary>

В старых версиях применялся устаревший алгоритм хэширования, основанный на md5.
  
</details>

7. Сделайте скриншот содержимого конфиденциального документа, расположенного по пути `/home/boss`.

<details>
  <summary> Подсказка</summary>

Для просмотра содержимого документа можете использовать команду `cat <имя файла>`.
  
</details>

8. Далее вам необходимо закрыть уязвимости. Расшифруйте пароль пользователя «msfadmin». Войдите под ним на самой уязвимой машине.

9. Удалите пользователя «test». Сделайте скриншот, что его больше нет в списке пользователей.

10. Удалите уязвимый сервис tasks. В каталоге bd создайте личные каталоги для пользователей «boss», «alex», «natasha». Настройте права доступа, чтобы у каждого пользователя был доступ только к своему каталогу. Сделайте скриншот содержимого каталога с отображением назначенных прав.

#### Дополнительное задание (является необязательным и не влияет на получение зачета)

1. Включите на уязвимой машине межсетевой экран ufw. Настройте его таким образом, чтобы были доступны только порты 80, 21.
2. Заново просканируйте открытые порты с использованием Nmap.
3. Сделайте скриншот.

------

### Правила приёма работы

Отправлен отчёт с выполненным заданием в личном кабинете.

-----

### Критерии оценки

Для зачёта должны быть представлены все скриншоты, указанные в блоке «Алгоритм задания».

Работа направляется на доработку, если приложены не все скриншоты, работа выполнена частично или не выполнена.
